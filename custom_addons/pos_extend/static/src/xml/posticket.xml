<?xml version="1.0" encoding="UTF-8"?>
<templates id="template" xml:space="preserve">
	<t t-extend="PosTicket">
		<t t-jquery="div[class*='pos-sale-ticket']" t-operation="replace">

		<div class="pos-sale-ticket">
			<div class="company_card">
				<div class="company_logo">
					<img src='/web/binary/company_logo' style="width:40%"/>
				</div>
				<div class="company_info">
					<span  class="company_name"><t t-esc="widget.pos.company.name"/>(<t t-esc="widget.pos.config.name || ''"/>)</span><br />
				</div>
			</div>
			<div name="order_info">
				<strong>Cashier: </strong><t t-esc="widget.pos.cashier ? widget.pos.cashier.name : widget.pos.user.name"/><br/>
				<strong>Bill No: </strong><t t-esc="order.name"/><br />
				<strong>Date: </strong><t t-esc="moment().format('DD/MM/YYYY LT')"/><br />
				<t t-set="client" t-value="order.get_client()"/>
				<t t-if="client and widget.pos.config.receipt_customer_vat">
					<t t-set="client" t-value="order.get_client()"/>
					<t t-esc="order.get_label_text().label_customer" /><t t-esc="client['name']"/><br />
					<t t-esc="order.get_label_text().label_customerphone" /><t t-esc="client['phone'] || client['mobile'] || ''"/>
				</t>
				<br />
			</div>
			<t t-if="receipt.header">
				<div style='text-align:center'>
					<t t-esc="receipt.header" />
				</div>
			</t>
			<table class='receipt-orderlines' style="border-top: 1px dashed;">
				<tr style="border-bottom: 1px dashed;">
					<th class="pos-left-align" width='40%'>Item Name</th>
					<th class="center" width='15%'>Qty</th>
					<th class="pos-right-align" width='13%'>UnitPrice</th>
					<th class="pos-right-align" width='27%'>Price</th>
				</tr>
				<t t-set="priceDiscount" t-value="0"/>
				<t t-foreach="orderlines" t-as="orderline">
					<t t-if="! orderline.get_product().display_name.split('[GD]')[1]">
						<tr>
							<td style="border-bottom: dotted 1px #000;padding-top:3px;">
								<div style="line-height: 1.1em;">
									<t t-if="orderline.get_product().display_name.split(']')[1]">
										<span t-esc="orderline.get_product().display_name.split(']')[1]"/>
									</t>
									<t t-else="">
										<span t-esc="orderline.get_product().display_name"/>
									</t>
								</div>
							</td>
							<td class="center" style="border-bottom: dotted 1px #000">
								<t t-esc="orderline.get_quantity()"/>
								<t t-if='orderline.get_unit().name != "Unit(s)"'>
									<t t-esc='orderline.get_unit().name' />
								</t>
							</td>
							<td class="pos-right-align" style="border-bottom: dotted 1px #000">
								<t t-esc="widget.format_currency_no_symbol(orderline.price)" />
							</td >
							<td class="pos-right-align" style="border-bottom: dotted 1px #000">
								<t t-esc="widget.format_currency_no_symbol(orderline.get_display_price())"/>
							</td>
						</tr>
					</t>
					<t t-else="">
						<t t-set="priceDiscount" t-value="priceDiscount + orderline.get_display_price()"></t>
					</t>
				</t>
			</table>
			<!-- Subtotal and Totals -->
			<table class='receipt-total'>
				<br/>
				<tr class="emph">
					<td style="font-size: 13px;">Total</td>
					<td class="pos-right-align" style="font-size: 13px;">
						<t t-esc="widget.format_currency(order.get_total_with_tax() + Math.abs(priceDiscount)) "/><br />
					</td>
				</tr>
				<t t-if="priceDiscount != 0">
					<tr class="emph">
						<td  style="font-size: 13px;">Discount</td>
						<td class="pos-right-align" style="font-size: 13px;">
							<t t-esc="widget.format_currency(Math.abs(priceDiscount))"/><br />
						</td>
					</tr>
				</t>
				<tr class="emph">
					<td  style="font-size: 13px;">Sub Total</td>
					<td class="pos-right-align" style="font-size: 13px;">
						<t t-esc="widget.format_currency(order.get_total_with_tax()) "/><br />
					</td>
				</tr>
				<tr class="emph">
					<td  style="font-size: 13px;">Tax</td>
					<td class="pos-right-align" style="font-size: 13px;">
						<t t-esc="widget.format_currency(order.get_total_with_tax() * 0.1)"/><br />
					</td>
				</tr>
				<tr class="emph">
					<td  style="border-bottom: dotted 1px #000; font-size: 13px;">Sub Total(KHR)</td>
					<td class="pos-right-align"  style="font-size: 13px; border-bottom: dotted 1px #000">
						<t t-esc="widget.format_currency_no_symbol(order.get_total_with_tax() * order.exchange_rate)+'áŸ›'"/>
					</td>
				</tr>
				<tr class="emph">
					<td  style="border-bottom: dotted 1px #000; font-size: 13px;">Total Sales</td>
					<td class="pos-right-align" style="border-bottom: dotted 1px #000; font-size: 13px;">
						<t t-esc="widget.format_currency(order.get_total_with_tax())"/><br />
					</td>
				</tr>
			</table>
			<br />
			<table class='receipt-paymentlines'>
				<t t-foreach="paymentlines" t-as="line">
					<tr>
					  <td>
						  <t t-esc="line.name"/>
					  </td>
					  <td class="pos-right-align">
						  <t t-esc="widget.format_currency(order.get_total_with_tax())"/>
					  </td>
				  </tr>
				  <tr>
					  <td>
						  <!--<t t-esc="line.name"/>-->
						  Tendered
					  </td>
					  <td class="pos-right-align">
						  <t t-esc="widget.format_currency(line.get_amount())"/>
					  </td>
				  </tr>
				</t>
			</table>
			<table class='receipt-change'>
				<tr><td style="border-bottom: dotted 1px #000">Change</td>
					<td class="pos-right-align" style="border-bottom: dotted 1px #000">
						<t t-esc="widget.format_currency(order.get_change())"/>
					</td>
				</tr>
			</table>
			<t t-if="order.note">
				<div>
					<div class='entry note'>
						<span class="label"><t t-esc="order.get_label_text().label_note" /></span>
						<div class='order_note'><span class="value"><t t-esc="order.note" /></span></div>
					</div>
				</div>
			</t>
			<div align="center" style="font-size: 11px;">All our prices are in US dollars inclusive VAT</div>
			<div align="center">Thank You Please Come Again</div>
			<t t-if="receipt.footer">
				<div align="center" style="margin-top: 3px;font-size=12px">
					<pre><t t-esc="receipt.footer" /></pre>
				</div>
			</t>
		</div>
		</t>
	</t>
	<t t-extend="Chrome">
		<t t-jquery='.pos-logo' t-operation='replace'>
			<img class="pos-logo" src="/web/binary/company_logo" />
		</t>
	</t>
</templates>